(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-space-post"],{"011f":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"user",class:t.AppStyle},[e("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[e("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[e("v-uni-view",{staticClass:"action",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.back.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-back"})],1),e("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["add"==t.postType?[0==t.type?[t._v("发布新动态")]:t._e(),1==t.type?[t._v("转发文章")]:t._e(),2==t.type?[t._v("转发动态")]:t._e(),4==t.type?[t._v("发布视频动态")]:t._e(),5==t.type?[t._v("转发商品")]:t._e()]:[t._v("编辑动态")]],2),e("v-uni-view",{staticClass:"action"},["add"==t.postType?[e("v-uni-button",{staticClass:"cu-btn round bg-gradual-orange",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.addSpace()}}},[t._v("发布")])]:[e("v-uni-button",{staticClass:"cu-btn round bg-gradual-orange",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.editSpace()}}},[t._v("保存")])]],2)],1)],1),e("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),e("v-uni-form",[e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-textarea",{attrs:{maxlength:"-1",placeholder:"输入您现在的想法"},model:{value:t.text,callback:function(i){t.text=i},expression:"text"}})],1),e("v-uni-view",{staticClass:"comments-owo space-owo"},[e("v-uni-text",{staticClass:"cuIcon-emoji",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.OwO.apply(void 0,arguments)}}}),t.isOwO?e("v-uni-view",{staticClass:"owo"},[e("v-uni-scroll-view",{staticClass:"owo-list",attrs:{"scroll-y":!0}},[e("v-uni-view",{staticClass:"owo-main"},t._l(t.owoList,(function(i,n){return e("v-uni-view",{key:n,staticClass:"owo-lit-box",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setOwO(i)}}},[e("v-uni-image",{attrs:{src:"/"+i.icon,mode:"aspectFill"}})],1)})),1)],1),e("v-uni-view",{staticClass:"owo-type"},[e("v-uni-view",{staticClass:"owo-box",class:"paopao"==t.OwOtype?"cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toOwO("paopao")}}},[t._v("泡泡")]),e("v-uni-view",{staticClass:"owo-box",class:"adai"==t.OwOtype?"cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toOwO("adai")}}},[t._v("阿呆")]),e("v-uni-view",{staticClass:"owo-box",class:"alu"==t.OwOtype?"cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toOwO("alu")}}},[t._v("阿鲁")]),e("v-uni-view",{staticClass:"owo-box",class:"quyinniang"==t.OwOtype?"cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toOwO("quyinniang")}}},[t._v("蛆音娘")])],1)],1):t._e()],1),0==t.type?[e("v-uni-view",{staticClass:"grid flex-sub col-3 grid-square space-pic"},[t._l(t.picList,(function(i,n){return e("v-uni-view",{key:n,staticClass:"bg-img",style:"background-image:url("+i+");"},[e("v-uni-text",{staticClass:"cuIcon-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.picClose(i)}}})],1)})),t.picList.length<9?e("v-uni-view",{staticClass:"space-upload",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.upload.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-add"})],1):t._e()],2)]:t._e(),4==t.type?[e("v-uni-view",{staticClass:"grid flex-sub col-3 grid-square space-pic"},[""==t.pic?e("v-uni-view",{staticClass:"space-upload",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.uploadVideo.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-add"})],1):t._e(),""!=t.pic?e("v-uni-view",{staticClass:"space-upload "},[e("v-uni-text",{staticClass:"cuIcon-close bg-black",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.pic=""}}})],1):t._e()],1)]:t._e(),2==t.type?[null!=t.forwardJson?e("v-uni-view",{staticClass:"grid flex-sub padding-sm bg-white"},[e("v-uni-view",{staticClass:"user-space-info"},[e("v-uni-view",{staticClass:"user-space-text"},[e("v-uni-text",{staticClass:"text-blue"},[t._v("@"+t._s(t.forwardJson.userJson.name)+"：")]),t._v(t._s(t.forwardJson.text))],1)],1)],1):t._e()]:t._e(),1==t.type?[null!=t.contentJson&&0!=t.contentJson.cid?e("v-uni-view",{staticClass:"grid flex-sub padding-lr margin-top-sm"},[e("v-uni-view",{staticClass:"user-post-info"},[t.contentJson.images.length>0?e("v-uni-view",{staticClass:"user-post-pic"},[e("v-uni-image",{attrs:{src:t.contentJson.images[0],mode:"widthFix"}})],1):t._e(),e("v-uni-view",{staticClass:"user-post-text"},[e("v-uni-view",{staticClass:"user-post-title"},[t._v(t._s(t.contentJson.title))]),e("v-uni-view",{staticClass:"user-post-intro"},[t._v(t._s(t.contentJson.text))])],1)],1)],1):t._e()]:t._e(),5==t.type?[null!=t.shopJson&&0!=t.shopJson.id?e("v-uni-view",{staticClass:"grid flex-sub padding-lr"},[e("v-uni-view",{staticClass:"user-post-info"},[e("v-uni-view",{staticClass:"user-post-pic"},[e("v-uni-image",{attrs:{src:t.shopJson.imgurl,mode:"widthFix"}})],1),e("v-uni-view",{staticClass:"user-post-text"},[e("v-uni-view",{staticClass:"user-post-title"},[t._v(t._s(t.shopJson.title))]),e("v-uni-view",{staticClass:"user-post-intro"},[e("v-uni-text",{staticClass:"text-red text-lg text-bold"},[t._v(t._s(parseInt(t.shopJson.price))+" "+t._s(t.currencyName))])],1),e("v-uni-view",{staticClass:"user-post-intro"},[e("v-uni-text",{staticClass:"text-gray text-sm"},[t._v("剩余数量："+t._s(t.shopJson.num))])],1)],1)],1)],1):t._e()]:t._e()],2)],1)},o=[]},"66d0":function(t,i,e){"use strict";e("7a82");var n=e("4ea4").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("ac1f"),e("1276"),e("5319"),e("5b81"),e("c975"),e("14d9");var o=e("0af4"),a=n(e("4596")),s={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,id:0,postType:"add",type:0,text:"",toid:0,pic:"",picList:[],token:"",currencyName:"",forwardJson:null,contentJson:null,shopJson:null,isOwO:!1,owo:a.default,owoList:[],OwOtype:"paopao"}},onPullDownRefresh:function(){},onHide:function(){o.localStorage.removeItem("getuid")},onShow:function(){o.localStorage.getItem("token")&&(this.token=o.localStorage.getItem("token"))},onLoad:function(t){this.currencyName=this.$API.getCurrencyName(),this.owoList=this.owo.data.paopao.container,t.type&&(this.type=t.type),t.toid&&(this.toid=t.toid,this.getInfo()),t.postType&&(this.postType=t.postType),t.id&&(this.id=t.id,"add"==this.postType?this.getForwardInfo(this.id):this.getSpaceInfo())},methods:{back:function(){uni.navigateBack({delta:1})},toOwO:function(t){this.OwOtype=t,"paopao"==t&&(this.owoList=this.owo.data.paopao.container),"adai"==t&&(this.owoList=this.owo.data.adai.container),"alu"==t&&(this.owoList=this.owo.data.alu.container),"quyinniang"==t&&(this.owoList=this.owo.data.quyinniang.container)},setOwO:function(t){var i=t.data;this.text+=i,this.isOwO=!1},OwO:function(){this.isOwO=!this.isOwO},getForwardInfo:function(t){var i=this,e={id:t};i.$Net.request({url:i.$API.spaceInfo(),data:e,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){i.isLoading=1,1==t.data.code&&(i.forwardJson=t.data.data,i.toid=t.data.data.id)},fail:function(t){i.isLoading=1}})},replaceAll:function(t,i,e){return t.split(i).join(e)},getSpaceInfo:function(){var t=this,i={id:t.id};t.$Net.request({url:t.$API.spaceInfo(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(t.isLoading=1,1==i.data.code){t.id=i.data.data.id,t.type=i.data.data.type;var e=i.data.data.text;e=t.replaceAll(e,"/r/n","\n"),e=t.replaceAll(e,"||rn||","\n"),t.text=e,t.toid=i.data.data.toid,i.data.data.pic&&(t.pic=i.data.data.pic,0==t.type&&(-1!=t.pic.indexOf("||")?t.picList=t.pic.split("||"):t.picList=t.picList.push(t.pic))),1==t.type&&(t.contentJson=i.data.data.contentJson),5==t.type&&(t.shopJson=i.data.data.shopJson),2==t.type&&t.getForwardInfo(t.toid)}},fail:function(i){t.isLoading=1}})},getInfo:function(){var t=this,i={key:t.toid,isMd:0};t.$Net.request({url:t.$API.getContentsInfo(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){uni.stopPullDownRefresh(),i.data.title&&(t.contentJson=i.data)},fail:function(t){uni.stopPullDownRefresh()}})},addSpace:function(){var t=this;if(""==t.token){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}if(2==t.type&&""==t.text&&(i="转发了动态"),""==t.text)return uni.showToast({title:"请输入动态内容",icon:"none",duration:1e3,position:"bottom"}),!1;var i=t.text;if(0==t.type){var e=t.picList,n="";for(var o in e)n+=0==o?e[o]:"||"+e[o];t.pic=n}if(4==t.type&&""==t.pic)return uni.showToast({title:"请上传视频文件",icon:"none",duration:1e3,position:"bottom"}),!1;i=i.replace(/\r\n/g,"||rn||"),i=i.replace(/\n/g,"||rn||");var a={type:t.type,text:i,toid:t.toid,pic:t.pic,token:t.token};uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.addSpace(),data:t.$API.removeObjectEmptyKey(a),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:i.data.msg,icon:"none"}),1==i.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},editSpace:function(){var t=this;if(""==t.token){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}if(2==t.type&&""==t.text&&(i="转发了动态"),""==t.text)return uni.showToast({title:"请输入动态内容",icon:"none",duration:1e3,position:"bottom"}),!1;var i=t.text;if(0==t.type){var e=t.picList,n="";for(var o in e)n+=0==o?e[o]:"||"+e[o];t.pic=n}if(4==t.type&&""==t.pic)return uni.showToast({title:"请上传视频文件",icon:"none",duration:1e3,position:"bottom"}),!1;i=i.replace(/\r\n/g,"||rn||"),i=i.replace(/\n/g,"||rn||");var a={id:t.id,type:t.type,text:i,toid:t.toid,pic:t.pic,token:t.token};uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.editSpace(),data:t.$API.removeObjectEmptyKey(a),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:i.data.msg,icon:"none"}),1==i.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},upload:function(){var t=this;uni.chooseImage({count:9,sizeType:["original"],sourceType:["album","camera"],success:function(i){uni.showLoading({title:"加载中"});for(var e=i.tempFilePaths,n=0;n<e.length;n++)uni.uploadFile({url:t.$API.upload(),filePath:e[n],name:"file",formData:{token:t.token},success:function(i){1==e.length&&setTimeout((function(){uni.hideLoading()}),1e3);var n=JSON.parse(i.data);if(uni.showToast({title:n.msg,icon:"none"}),1==n.code){var o=n.data.url;t.picList.push(o)}},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}})}})},uploadVideo:function(){var t=this;uni.chooseVideo({sourceType:["camera","album"],compressed:!1,success:function(i){uni.showLoading({title:"加载中"});var e=i.tempFilePath;uni.uploadFile({url:t.$API.upload(),filePath:e,name:"file",formData:{token:t.token},success:function(i){setTimeout((function(){uni.hideLoading()}),1e3);var e=JSON.parse(i.data);if(uni.showToast({title:e.msg,icon:"none"}),1==e.code){var n=e.data.url;t.pic=n}},fail:function(){uni.showToast({title:"网络异常，上传失败！",icon:"none"}),setTimeout((function(){uni.hideLoading()}),1e3)}})}})},picClose:function(t){var i=this.picList,e=[];for(var n in i)i[n]!=t&&e.push(i[n]);this.picList=e}}};i.default=s},d6f0:function(t,i,e){"use strict";e.r(i);var n=e("011f"),o=e("dcfe");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(a);var s=e("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"02b41c81",null,!1,n["a"],void 0);i["default"]=c.exports},dcfe:function(t,i,e){"use strict";e.r(i);var n=e("66d0"),o=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=o.a}}]);