(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-contents-shopinfo"],{"53da":function(t,e,i){"use strict";i.r(e);var n=i("e0f7"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},b588:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={mpHtml:i("a1ba").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"user",class:t.AppStyle},[n("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[n("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-back"})],1),n("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("商品详情")]),n("v-uni-view",{staticClass:"action"})],1)],1),n("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),n("v-uni-view",{staticClass:"info",staticStyle:{"margin-top":"10upx"}},[n("v-uni-view",{staticClass:"shopinfo-img"},[n("v-uni-image",{attrs:{src:t.imgurl,mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage(t.imgurl)}}})],1),n("v-uni-view",{staticClass:"shopinfo-title"},[t._v(t._s(t.title))]),n("v-uni-view",{staticClass:"shopinfo-info"},[n("v-uni-text",{staticClass:"text-sm shop-user text-blue",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toUserContents(t.userInfo)}}},[""!=t.userInfo.screenName?[t._v(t._s(t.userInfo.screenName))]:[t._v(t._s(t.userInfo.name))]],2),n("v-uni-text",{staticClass:"text-sm text-right text-gray"},[t._v("剩余数量："+t._s(t.num))])],1),n("v-uni-view",{staticClass:"info-content shop-content"},[n("mp-html",{attrs:{content:t.html,selectable:!0,"show-img-menu":!0,"lazy-load":!0,ImgCache:!0,markdown:!0}})],1)],1),0==t.isBuy||1==t.type?n("v-uni-view",{staticClass:"shopinfo-bar grid col-2"},[n("v-uni-view",{staticClass:"shopinfo-price"},[1==t.isvip?[t._v(t._s(parseInt(t.price*t.vipDiscount))+" "+t._s(t.currencyName)),n("v-uni-text",{staticClass:"text-yellow margin-left text-sm"},[t._v("VIP优惠")])]:[t._v(t._s(t.price)+" "+t._s(t.currencyName))]],2),n("v-uni-view",{staticClass:"shopinfo-btn"},[n("v-uni-text",{staticClass:"cu-btn bg-blue radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.shopBuy.apply(void 0,arguments)}}},[t._v("立即购买")])],1)],1):t._e(),1==t.isBuy&&1!=t.type?n("v-uni-view",{staticClass:"shopinfo-bar grid col-2"},[n("v-uni-view",{staticClass:"shopinfo-price"},[t._v("已购买")]),n("v-uni-view",{staticClass:"shopinfo-btn"},[n("v-uni-text",{staticClass:"cu-btn bg-blue radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toInfo.apply(void 0,arguments)}}},[t._v("查看详情")])],1)],1):t._e(),0==t.isLoading?n("v-uni-view",{staticClass:"loading"},[n("v-uni-view",{staticClass:"loading-main"},[n("v-uni-image",{attrs:{src:i("e5d4")}})],1)],1):t._e()],1)},s=[]},e0f7:function(t,e,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("14d9");var a=n(i("a1ba")),s=i("cfbc"),o={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,userInfo:"",sid:0,title:"",html:"",markdownData:{},price:"",num:"",imgurl:"",isLoading:0,isBuy:0,shopinfo:{},vipDiscount:0,vipPrice:0,scale:0,isvip:0,vip:0,currencyName:""}},components:{mpHtml:a.default},onReachBottom:function(){},onShow:function(){this.getVipInfo(),this.userStatus()},onPullDownRefresh:function(){this.getInfo(this.sid),this.isBuyShop(this.sid)},onLoad:function(t){this.currencyName=this.$API.getCurrencyName(),t.sid&&(this.sid=t.sid,this.getInfo(this.sid))},methods:{back:function(){uni.navigateBack({delta:1})},getInfo:function(t){var e=this,i={key:e.sid};e.$Net.request({url:e.$API.shopInfo(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){uni.stopPullDownRefresh(),e.shopinfo=t.data,e.title=t.data.title,e.type=t.data.type,e.html=t.data.text,e.imgurl=t.data.imgurl,e.price=t.data.price,e.num=t.data.num,e.vipDiscount=t.data.vipDiscount,1!=t.data.type&&e.isBuyShop(e.sid),e.getUserInfo(t.data.uid);setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){uni.stopPullDownRefresh(),uni.showToast({title:"网络开小差了哦",icon:"none"});setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},previewImage:function(t){var e=[];e.push(t),uni.previewImage({urls:e,current:e[0]})},shopBuy:function(){var t="";if(!s.localStorage.getItem("userinfo")){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"../user/login"}),clearTimeout("timer")}),1e3);return!1}var e=JSON.parse(s.localStorage.getItem("userinfo"));t=e.token;var i={token:t,sid:this.sid};uni.showLoading({title:"加载中"}),this.$Net.request({url:this.$API.buyShop(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code)setTimeout((function(){uni.redirectTo({url:"/pages/user/order"}),clearTimeout("timer")}),1e3);else if("购买实体商品前，需要先设置收货地址"==t.data.msg)setTimeout((function(){uni.redirectTo({url:"/pages/user/address"}),clearTimeout("timer")}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})},getUserInfo:function(t){var e=this,i={key:t};e.$Net.request({url:e.$API.getUserInfo(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){1==t.data.code&&(e.userInfo=t.data.data,e.userInfo.style="background-image:url("+t.data.data.avatar+");")},fail:function(t){}})},toInfo:function(){var t=this.shopinfo;1==t.type?uni.showToast({title:"实体商品请留意快递信息",icon:"none"}):uni.navigateTo({url:"/pages/contents/shoptext?sid="+t.id})},isBuyShop:function(t){var e=this,i="";if(s.localStorage.getItem("userinfo")){var n=JSON.parse(s.localStorage.getItem("userinfo"));i=n.token}var a={sid:e.sid,token:i};e.$Net.request({url:e.$API.isBuyShop(),data:a,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){1==t.data.code&&(e.isBuy=1)},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})},toUserContents:function(t){var e=t.name,i=t.name+"的信息";t.screenName&&(i=t.screenName+" 的信息",e=t.screenName);var n=t.uid;uni.navigateTo({url:"/pages/contents/userinfo?title="+i+"&name="+e+"&uid="+n+"&avatar="+encodeURIComponent(t.avatar)})},getVipInfo:function(){var t=this;t.$Net.request({url:t.$API.getVipInfo(),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.vipPrice=e.data.data.vipPrice,t.scale=e.data.data.scale);setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)},fail:function(e){setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)}})},userStatus:function(){var t=this,e="";if(s.localStorage.getItem("userinfo")){var i=JSON.parse(s.localStorage.getItem("userinfo"));e=i.token}t.$Net.request({url:t.$API.userStatus(),data:{token:e},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.vip=e.data.data.vip,t.isvip=e.data.data.isvip)},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})}}};e.default=o},e5d4:function(t,e,i){t.exports=i.p+"static/img/loading.edead6c4.gif"},f939:function(t,e,i){"use strict";i.r(e);var n=i("b588"),a=i("53da");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o=i("f0c5"),u=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"9eaed732",null,!1,n["a"],void 0);e["default"]=u.exports}}]);